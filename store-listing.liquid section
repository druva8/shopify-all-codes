<section class="store-listings">
  <div class="stse_drop_dwon activated" onclick="toggleCity(this)">
    <h3 class="sub_heding_stse">{{ section.settings.city_name }}</h3>
    <span class="toggle-icon">
      <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M11 5.5L7 9.5L3 5.5" stroke="currentColor" stroke-width="var(--icon-stroke-width)" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </span>
  </div>

  <div class="toggl_data_state actived_main_stse">
    <div class="store-list-container">
      {% for block in section.blocks %}
        {% assign store = block.settings %}
        <div class="store-item" style="background-color: {{ block.settings.block_background_color | default: section.settings.card_background_color | default: '#ffffff' }};">
          {% if store.image %}
            <img
              src="{{ store.image | img_url: '600x' }}"
              alt="{{ store.store_name }}"
              class="store-image"
              width="100%"
              height="180"
            >
          {% endif %}

          <p class="store-name">{{ store.store_name }}</p>

          <div class="inner_main_contente">
            <div class="inner_text_store">
              <div class="inner_height_data">
                {% if store.address %}
                  <p class="store-address">{{ store.address }}</p>
                {% endif %}

                {% if store.phone %}
                  <p class="store-contact">
                    Call us:
                    <a class="teliphone_first" href="tel:{{ store.phone | strip }}">{{ store.phone }}</a>
                  </p>
                {% endif %}

                {% if store.days %}
                  <p class="store-opening-days">{{ store.days }}</p>
                {% endif %}

                {% if store.hours %}
                  <p class="store-opening-hours">{{ store.hours }}</p>
                {% endif %}
              </div>

              {% if store.collection_url %}
                <a class="view_store_collection" href="{{ store.collection_url }}">View collection</a>
              {% endif %}
            </div>

            <div class="store-actions">
              {% if store.phone %}
                <a href="tel:{{ store.phone | strip }}" class="store-link" aria-label="Phone">
                  <div class="icon-circle">{% render 'icon-phone' %}</div>
                </a>
              {% endif %}

              {% if store.whatsapp %}
                <a
                  href="https://api.whatsapp.com/send/?phone={{ store.whatsapp | remove: '+' }}&text=Hello%21+I+am+interested+in+your+store"
                  target="_blank"
                  class="store-link"
                  aria-label="WhatsApp"
                >
                  <div class="icon-circle">{% render 'icon-video' %}</div>
                </a>
              {% endif %}

              {% if store.map_url %}
                <a href="{{ store.map_url }}" target="_blank" class="store-link" aria-label="Location">
                  <div class="icon-circle">{% render 'icon-share' %}</div>
                </a>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>

  <style>
    /* ---------- Container and Layout ---------- */
    .store-listings {
      margin: 40px auto;
      max-width: 1200px;
      padding: 0 15px;
    }

    /* ---------- Dropdown City Header ---------- */
    .stse_drop_dwon {
      background: #f8f8f8;
      padding: 15px 25px;
      cursor: pointer;
      border-radius: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
      border: 1px solid #ddd;
    }

    .stse_drop_dwon:hover { background: #f1f1f1; }

    .sub_heding_stse {
      font-size: 22px;
      font-weight: 700;
      color: #a42829;
      margin: 0;
      text-transform: uppercase;
    }

    .toggle-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 14px; /* Match SVG width */
      height: 14px; /* Match SVG height */
      color: #a42829;
      transition: transform 0.3s ease;
    }

    .toggle-icon svg {
      width: 100%;
      height: 100%;
      stroke-width: 2px; /* Define var(--icon-stroke-width) fallback */
    }

    /* ---------- Animation ---------- */
    .toggl_data_state {
      overflow: hidden;
      max-height: 0;
      opacity: 0;
      transition: all 0.5s ease;
    }

    .toggl_data_state.active {
      max-height: 2000px;
      opacity: 1;
      margin-top: 20px;
    }

    /* ---------- Store Grid ---------- */
    .store-list-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-top: 10px;
    }

    /* ---------- Store Card ---------- */
    .store-item {
      border: 1px solid #e5e5e5;
      border-radius: 10px;
      padding: 15px;
      transition: all 0.3s ease;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }

    .store-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    }

    /* ---------- Image ---------- */
    .store-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 10px;
    }

    /* ---------- Text Styles ---------- */
    .store-name {
      font-weight: 700;
      color: #a42829;
      font-size: 16px;
      margin-bottom: 8px;
      text-transform: capitalize;
    }

    .store-address {
      font-size: 14px;
      color: #555;
      margin-bottom: 6px;
      line-height: 1.4;
    }

    .store-contact {
      font-size: 14px;
      margin-bottom: 4px;
      color: #333;
    }

    .store-contact a {
      color: #a42829;
      text-decoration: none;
    }

    .store-opening-days {
      font-size: 14px;
      color: #333;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .store-opening-hours {
      font-size: 13px;
      color: #666;
      margin-bottom: 8px;
    }

    .view_store_collection {
      display: inline-block;
      color: #a42829;
      font-weight: 600;
      text-decoration: none;
      font-size: 14px;
    }

    .view_store_collection:hover {
      text-decoration: underline;
    }

    /* ---------- Action Buttons ---------- */
    .store-actions {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 10px;
    }

    .icon-circle {
      width: 40px;
      height: 40px;
      background: #a42829;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-size: 18px;
      transition: all 0.3s ease;
    }

    .icon-circle:hover {
      background: #8d1f22;
      transform: scale(1.1);
    }

    /* ---------- Toggle Arrow Rotation ---------- */
    .stse_drop_dwon .toggle-icon {
      transform: rotate(0deg);
    }

    .stse_drop_dwon.active .toggle-icon {
      transform: rotate(-180deg);
    }

    /* ---------- Responsive ---------- */
    @media (max-width: 768px) {
      .store-image { height: 150px; }
      .store-name { font-size: 15px; }
      .store-list-container { grid-template-columns: 1fr; }
      .store-listings { padding: 0 10px; }
      .sub_heding_stse { font-size: 18px; }
    }
  </style>

  <script>
    function toggleCity(el) {
      const next = el.nextElementSibling;
      el.classList.toggle('active');
      next.classList.toggle('active');
    }
  </script>
</section>

{% schema %}
{
  "name": "Store Listings (Dropdown)",
  "settings": [
    {
      "type": "text",
      "id": "city_name",
      "label": "City Name",
      "default": "CHENNAI"
    }
  ],
  "blocks": [
    {
      "type": "store",
      "name": "Store Item",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Store Image" },
        { "type": "text", "id": "store_name", "label": "Store Name" },
        { "type": "text", "id": "address", "label": "Address" },
        { "type": "text", "id": "phone", "label": "Phone Number" },
        { "type": "text", "id": "days", "label": "Open Days", "default": "Open 7 days a week" },
        { "type": "text", "id": "hours", "label": "Opening Hours", "default": "9:00 am - 9:30 pm" },
        { "type": "url", "id": "collection_url", "label": "Collection URL" },
        { "type": "text", "id": "whatsapp", "label": "WhatsApp Number (with +91...)" },
        { "type": "url", "id": "map_url", "label": "Google Map URL" },
        {
          "type": "color",
          "id": "block_background_color",
          "label": "Block Background Color",
          "default": "#ffffff"
        }
      ]
    }
  ],
  "presets": [{ "name": "Store Listings (Dropdown)" }]
}
{% endschema %}
