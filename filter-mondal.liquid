<!-- /snippets/filter-modal.liquid -->
<!-- Refine Modal Trigger Button -->
<button
  id="openFilterModal"
  class="md:hidden px-4 py-2 border rounded bg-gray-100 text-sm font-semibold"
  type="button">
  {{ 'products.product.refine' | t }}
</button>

<!-- Modal -->
<div
  id="filterModal"
  class="fixed inset-0 z-50 bg-black bg-opacity-50 hidden"
  aria-hidden="true">
  <div class="absolute inset-0 flex items-center justify-center">
    <div class="bg-white w-11/12 max-w-sm p-6 rounded shadow-lg relative">
      <button
        id="closeFilterModal"
        class="absolute top-2 right-2 text-gray-600 hover:text-black"
        aria-label="Close">
        &times;
      </button>

      <!-- Sort Form -->
      <facet-filters-form class="facets">
        <form class="facets-vertical-form" id="FacetSortForm">
          <div class="facet-filters sorting caption">
            <div class="facet-filters__field">
              <h2 class="facet-filters__label caption-large text-body">
                <label for="SortBy">{{ 'products.facets.sort_by_label' | t }}</label>
              </h2>
              <div class="select relative">
                {%- assign sort_by = collection.sort_by | default: collection.default_sort_by -%}
                <select
                  name="sort_by"
                  class="facet-filters__sort select__select caption-large w-full border p-2"
                  id="SortBy"
                  aria-describedby="a11y-refresh-page-message">
                  {%- for option in collection.sort_options -%}
                    <option
                      value="{{ option.value | escape }}"
                      {% if option.value == sort_by %}
                      selected="selected"
                      {% endif %}>
                      {{ option.name | escape }}
                    </option>
                  {%- endfor -%}
                </select>
                <span class="absolute right-2 top-3 svg-wrapper">
                  {{- 'icon-caret.svg' | inline_asset_content -}}
                </span>
              </div>
            </div>
          </div>
        </form>
      </facet-filters-form>
    </div>
  </div>
</div>

<!-- JS to control modal -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const openBtn = document.getElementById('openFilterModal');
    const closeBtn = document.getElementById('closeFilterModal');
    const modal = document.getElementById('filterModal');
  
    if (openBtn && closeBtn && modal) {
      openBtn.addEventListener('click', () => {
        modal.classList.remove('hidden');
        modal.setAttribute('aria-hidden', 'false');
      });
  
      closeBtn.addEventListener('click', () => {
        modal.classList.add('hidden');
        modal.setAttribute('aria-hidden', 'true');
      });
  
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          modal.classList.add('hidden');
          modal.setAttribute('aria-hidden', 'true');
        }
      });
    }
  });
</script>
